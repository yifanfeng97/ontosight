import{r as i,u as b,a as R,j as p}from"./index-WuE-ptUs.js";import{s as S,G as C}from"./preset-BbVrjj7R.js";const L=i.memo(function({data:a,meta:x}){const l=i.useRef(null),f=i.useRef(null),r=i.useRef(null),{selectedNodes:o,selectNode:v,deselectNode:d,clearSelection:c}=b(),{results:h}=R(),y=i.useCallback(e=>{const n=e.item;if(!n)return;const t=n.get("id");o.has(t)?d(t):v(t)},[o,v,d]),k=i.useCallback(()=>{c()},[c]),w=i.useCallback(e=>{const n=e.item;if(!n||!r.current)return;const t=n.getModel(),{x:s,y:u}=n.getModel(),m=`
      <div class="graph-node-tooltip">
        <div class="tooltip-title">${t.label||t.id}</div>
        <div class="tooltip-id">ID: ${t.id}</div>
        ${t.description?`<div class="tooltip-desc">${t.description}</div>`:""}
        ${t.value!==void 0?`<div class="tooltip-value">Value: ${t.value}</div>`:""}
      </div>
    `;r.current.innerHTML=m,r.current.style.display="block",r.current.style.left=(s??0)+10+"px",r.current.style.top=(u??0)+10+"px"},[]),E=i.useCallback(()=>{r.current&&(r.current.style.display="none")},[]),g=i.useCallback(e=>{e.key==="Escape"?c():(e.ctrlKey||e.metaKey)&&e.key==="f"?(e.preventDefault(),S.info("搜索面板已激活")):e.key==="Delete"&&o.size>0&&(o.forEach(n=>{d(n)}),S.success("已清除选中节点"))},[o,c,d]),N=i.useCallback(e=>{if(!e)return;const n=e.getNodes(),t=new Set(h);if(n.forEach(s=>{const u=s.getID();t.has(u)?(s.toFront(),e.setItemState(s,"highlight",!0)):e.setItemState(s,"highlight",!1)}),h.length>0){const s=e.findById(h[0]);s&&e.focusItem(s,!0)}},[h]);return i.useEffect(()=>{if(!l.current||!a.nodes)return;f.current&&f.current.destroy(),(void 0)("highlight")||(void 0)("highlight",{getEvents(){return{"node:mouseenter":"onNodeEnter","node:mouseleave":"onNodeLeave"}},onNodeEnter(t){const{item:s}=t;this.graph.setItemState(s,"highlight",!0)},onNodeLeave(t){const{item:s}=t;this.graph.setItemState(s,"highlight",!1)}});const e=new C({container:l.current,width:l.current.clientWidth,height:l.current.clientHeight,modes:{default:["drag-canvas","zoom-canvas","drag-node"]},nodeStateStyles:{highlight:{fill:"#ffd666",stroke:"#faad14",lineWidth:2,shadowColor:"#faad14",shadowBlur:10},selected:{fill:"#1890ff",stroke:"#1890ff",lineWidth:3,shadowColor:"#1890ff",shadowBlur:10}},edgeStateStyles:{highlight:{stroke:"#faad14",lineWidth:2,opacity:1}}});e.data({nodes:a.nodes.map(t=>({...t,size:30,style:{fill:o.has(t.id)?"#1890ff":"#87d068",lineWidth:o.has(t.id)?3:1,stroke:o.has(t.id)?"#1890ff":"#666"}})),edges:(a.edges||[]).map(t=>({...t,style:{stroke:"#ccc",lineWidth:1}}))}),e.on("node:click",y),e.on("canvas:click",k),e.on("node:mouseenter",w),e.on("node:mouseleave",E),e.on("node:dblclick",t=>{const s=t.item;if(!s)return;e.getNeighbors(s).forEach(m=>{e.setItemState(m,"highlight",!0)})}),e.render(),N(e);const n=()=>{l.current&&e.changeSize(l.current.clientWidth,l.current.clientHeight)};return window.addEventListener("resize",n),window.addEventListener("keydown",g),f.current=e,()=>{window.removeEventListener("resize",n),window.removeEventListener("keydown",g),e.destroy()}},[a,o,y,k,w,E,g,N]),p.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[p.jsx("div",{ref:l,className:"graph-view"}),p.jsx("div",{ref:r,className:"graph-tooltip",style:{display:"none"}})]})});export{L as default};
//# sourceMappingURL=GraphView-DDf8muwR.js.map
